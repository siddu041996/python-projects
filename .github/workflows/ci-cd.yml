name: python-code

on:
    push:
        branches: [ "master" ]
    pull_request:
        branches: [ "master" ]    

jobs:    
    build:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - name: Set up Python 3.10
              uses: actions/setup-python@v3
              with:
                python-version: "3.10"

            - name: ssh command
              uses: appleboy/ssh-action@master
              with:
                host: ${{ secrets.HOST }}
                username: ${{ secrets.USERNAME }}
                key: ${{ secrets.PASSWORD }}
                script: |
                  cd /home/ubuntu/koadz-project
                  git pull origin main
                  pip install -r requirements.txt 
                  python run.py >> /home/ubuntu/koadz-project/koadz.log